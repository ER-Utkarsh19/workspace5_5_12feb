# 1. Find all .c files recursively (this handles the files you kept)
file(GLOB_RECURSE BACNET_SOURCES "src/*.c")

# 2. Register the component
idf_component_register(
    SRCS ${BACNET_SOURCES}
    # "include/bacnet" ADDED below so files can find "bacapp.h" directly
    INCLUDE_DIRS "include" "include/bacnet" "src"
    REQUIRES lwip esp_wifi esp_netif driver esp_timer nvs_flash
)

# 3. Suppress all strict warnings to prevent build failure on legacy code
target_compile_options(${COMPONENT_LIB} PRIVATE
    -Wno-error
    -Wno-error=incompatible-pointer-types
    -Wno-error=char-subscripts
    -Wno-error=format
    -Wno-error=implicit-fallthrough
    -Wno-unused-variable
    -Wno-unused-function
)