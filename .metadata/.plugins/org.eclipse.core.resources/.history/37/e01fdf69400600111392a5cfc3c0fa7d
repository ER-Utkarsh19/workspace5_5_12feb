#include <stdint.h>
#include "esp_timer.h"
#include "bacnet/basic/sys/mstimer.h"

// Returns the time in milliseconds
unsigned long mstimer_now(void)
{
    return (unsigned long)(esp_timer_get_time() / 1000ULL);
}

// Optional: Used if the stack tries to verify timeouts
bool mstimer_expired(unsigned long *start, unsigned long interval_ms)
{
    unsigned long current = mstimer_now();
    return (current - *start) >= interval_ms;
}

void mstimer_set(unsigned long *start, unsigned long interval_ms)
{
    *start = mstimer_now();
